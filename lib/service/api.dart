import 'dart:convert';

import 'package:best_flutter_ui_templates/model/adherent.dart';
import 'package:best_flutter_ui_templates/model/plafondSousActe.dart';
import 'package:best_flutter_ui_templates/openid_io.dart';
import 'package:http/http.dart' as http;
import 'package:injectable/injectable.dart';

@lazySingleton
class Api {
  static const endpoint = 'http://10.0.2.2:9090/assurance';
  var client = new http.Client();
  Future<Adherent> getUserProfile(String  numero) async {




    String tocken = "eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJPM3E4UllvREF6VnNnZl9VTGt2ZzJOQVpQaG45Wmg2Z0F1NDltdUk5Y1BRIn0.eyJqdGkiOiI0YjUwMjhlZi00ZjgyLTRlODYtYTQ3MS05M2ExYjRmNDMyNGEiLCJleHAiOjE2ODIzMjUwMjUsIm5iZiI6MCwiaWF0IjoxNjgyMzI0NzI1LCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvYXV0aC9yZWFsbXMvVmltc28iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzNjNzA5ODEtMDBhYy00NDY0LWE3MmEtZTkzNWM2NDY5NjM5IiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYXNzdXJhbmNlLWFwcCIsIm5vbmNlIjoiNTBjM2U2YzYtNjJiZC00NGE4LWE5Y2YtNjRjZmI3NDdiMzc3IiwiYXV0aF90aW1lIjoxNjgyMzIzOTc5LCJzZXNzaW9uX3N0YXRlIjoiN2ZlYzRjODgtM2NmYi00NzA2LTlhNzQtOGQ0M2ViNWFiMzhiIiwiYWNyIjoiMCIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OjQyMDAiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbInNtX3RpZXJzX3BheWFudF9vcmRyZV9yZWdsZW1lbnRfZWRpdGlvbiIsInNtX3NpbmlzdHJlX2VkaXRpb24iLCJzbV90aWVyc19wYXlhbnRfY29uc3VsdGF0aW9uIiwic21fc2luaXN0cmVfdmFsaWRlIiwic21fb3JkcmVfcmVnbGVtZW50X3ZhbGlkZSIsInNtX2dhcmFudCIsInNtX3RpZXJzX3BheWFudF9vcmRyZV9yZWdsZW1lbnRfdmFsaWRlIiwic21fdGllcnNfcGF5YW50X29yZHJlX3JlZ2xlbWVudF9jb25zdWx0YXRpb24iLCJzbV90aWVyc19wYXlhbnRfZWRpdGlvbiIsInNtX3ByZXN0YXRpb24iLCJzbV90aWVyc19wYXlhbnQiLCJzbV9kYXNoYm9hcmQiLCJvZmZsaW5lX2FjY2VzcyIsInNtX3BvbGljZSIsInNtX2ludGVybWVkaWFpcmUiLCJzbV9wYXJhbWV0cmFnZSIsInNtX2V4ZXJjaWNlIiwic21fYmFyZW1lIiwidW1hX2F1dGhvcml6YXRpb24iLCJzbV9wcmVmaW5hbmNlbWVudCIsInNtX2ZpbmFuY2UiLCJzbV9wcm9kdWN0aW9uIiwic21fb3JkcmVfcmVnbGVtZW50X2VkaXRpb24iLCJST0xPX0FETUlOIiwic21fYnVsbGV0aW5fYWRoZXNpb24iLCJzbV90aWVyc19wYXlhbnRfdmFsaWRlIiwic21fYXZlbmFudCIsInNtX21lZGljYWwiLCJzbV9zaW5pc3RyZV9jb25zdWx0YXRpb24iLCJST0xFX0FETUlOIiwic21fb3JkcmVfcmVnbGVtZW50X2NvbnN1bHRhdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIGVtYWlsIHByb2ZpbGUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImxhdXJlbnQifQ.IBqjAjzMlefc_A3YW1f8XxIjMy45gqm1Oc4byPJ44hJMMVmzPIZ_GIzrPtDCj0ctcFivkkxzTMNko26xEPc3t9H75Yin_lLmlxXx5SxNDD_aqVYk9MYbZDsWGQ-YtPbA6jFODriinA3QRTonVGvgejg3xeY7x1QK1hfNeK8QMJ2oyPW9G_LdUG0Va6LO6q6bgXDEylMLH3YUlB9w6cvKKy-pzs_8JFV3PXUr2IMooCPHJ7KfrM5oFif1YIJNXhjqVs9K7Ei9aCwlWPFw9EFOMq3w9rybi6eg5EOEcEjRilACEcJo0JKuTgTg91QvHQHCpLkGpm9Clc8XklPf7KTGSg";

    var response = await client.get(Uri.parse('$endpoint/contrat/adherent/getAssureByNumero-adherent'),
        headers: {
          'Content-type': 'application/json',
          'Accept': 'application/json',
          'Authorization': 'Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJPM3E4UllvREF6VnNnZl9VTGt2ZzJOQVpQaG45Wmg2Z0F1NDltdUk5Y1BRIn0.eyJqdGkiOiJhOWQ4MjBiNi01ZmFkLTRhZTUtYWQ4Yy1iMmU4MjdhMjI0NGQiLCJleHAiOjE2ODIzMjU2MjIsIm5iZiI6MCwiaWF0IjoxNjgyMzI1MzIyLCJpc3MiOiJodHRwOi8vbG9jYWxob3N0OjgwODAvYXV0aC9yZWFsbXMvVmltc28iLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiYzNjNzA5ODEtMDBhYy00NDY0LWE3MmEtZTkzNWM2NDY5NjM5IiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiYXNzdXJhbmNlLWFwcCIsIm5vbmNlIjoiYzUxZDljYzMtNzQ2Yi00MDA5LTgxMWYtMWFmMzg1ZmE5NGE1IiwiYXV0aF90aW1lIjoxNjgyMzIzOTc5LCJzZXNzaW9uX3N0YXRlIjoiN2ZlYzRjODgtM2NmYi00NzA2LTlhNzQtOGQ0M2ViNWFiMzhiIiwiYWNyIjoiMCIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vbG9jYWxob3N0OjQyMDAiXSwicmVhbG1fYWNjZXNzIjp7InJvbGVzIjpbInNtX3RpZXJzX3BheWFudF9vcmRyZV9yZWdsZW1lbnRfZWRpdGlvbiIsInNtX3NpbmlzdHJlX2VkaXRpb24iLCJzbV90aWVyc19wYXlhbnRfY29uc3VsdGF0aW9uIiwic21fc2luaXN0cmVfdmFsaWRlIiwic21fb3JkcmVfcmVnbGVtZW50X3ZhbGlkZSIsInNtX2dhcmFudCIsInNtX3RpZXJzX3BheWFudF9vcmRyZV9yZWdsZW1lbnRfdmFsaWRlIiwic21fdGllcnNfcGF5YW50X29yZHJlX3JlZ2xlbWVudF9jb25zdWx0YXRpb24iLCJzbV90aWVyc19wYXlhbnRfZWRpdGlvbiIsInNtX3ByZXN0YXRpb24iLCJzbV90aWVyc19wYXlhbnQiLCJzbV9kYXNoYm9hcmQiLCJvZmZsaW5lX2FjY2VzcyIsInNtX3BvbGljZSIsInNtX2ludGVybWVkaWFpcmUiLCJzbV9wYXJhbWV0cmFnZSIsInNtX2V4ZXJjaWNlIiwic21fYmFyZW1lIiwidW1hX2F1dGhvcml6YXRpb24iLCJzbV9wcmVmaW5hbmNlbWVudCIsInNtX2ZpbmFuY2UiLCJzbV9wcm9kdWN0aW9uIiwic21fb3JkcmVfcmVnbGVtZW50X2VkaXRpb24iLCJST0xPX0FETUlOIiwic21fYnVsbGV0aW5fYWRoZXNpb24iLCJzbV90aWVyc19wYXlhbnRfdmFsaWRlIiwic21fYXZlbmFudCIsInNtX21lZGljYWwiLCJzbV9zaW5pc3RyZV9jb25zdWx0YXRpb24iLCJST0xFX0FETUlOIiwic21fb3JkcmVfcmVnbGVtZW50X2NvbnN1bHRhdGlvbiJdfSwicmVzb3VyY2VfYWNjZXNzIjp7ImFjY291bnQiOnsicm9sZXMiOlsibWFuYWdlLWFjY291bnQiLCJtYW5hZ2UtYWNjb3VudC1saW5rcyIsInZpZXctcHJvZmlsZSJdfX0sInNjb3BlIjoib3BlbmlkIGVtYWlsIHByb2ZpbGUiLCJlbWFpbF92ZXJpZmllZCI6ZmFsc2UsInByZWZlcnJlZF91c2VybmFtZSI6ImxhdXJlbnQifQ.UJVV_amAox1Zr-YLyXgvqMN55aUiaObEIV0OkfI714lvaDvVXzXFx2z8Lk-PBgG0JdUT-N_Qxewk6G61yv23EeqERPQsKqOkOdwy-jLWPQH8iP-erSCy4mqcRQeMdkfJz4_h-sit3aupzfLBdeRyHR_9kTSPBDP1FU_xNnpf-HDGJNsemMBpePfKzXivUQGRL3jV66AIWsYnhoZySugPm6o5qvtexzoWpA9Lyerf2wT-WRWoymDzr1hM0BiUfgh7w1keIM4e0CMdxNza8LkxReKJ2WrkBsvC6XY91t8eu2kJVsVa4g1hONWUq2HGnvHvjY8b14tovABiLo8sM3fNkA'
        }
    );
    print("=====================url=======1======");
    print(response.statusCode);
    return Adherent.fromJson(json.decode(response.body));
  }


  Future<List<PlafondSousActe>> findBareme() async {
    print("====================wiwiwiw=====4======");
    List<PlafondSousActe> plafonds = [];
    String username ="1";


    var response = await client.get(Uri.parse('$endpoint/contrat/plafond/username-connect' + '?' +username));
    //var parsed = json.decode(utf8.decode(response.bodyBytes));
    var parsed = json.decode(utf8.decode(response.bodyBytes));
    print("====================wiwiwiw===========");
    print(parsed);
    /*parsed.forEach((element) {
      PlafondSousActe data = PlafondSousActe.fromJson(json.decode(element));
      plafonds.add(data);
    });*/




    return plafonds;
  }


}